"undefined"==typeof AC&&(AC={}),"undefined"==typeof document.event&&(document.event={}),Event.Publisher&&Object.extend(document.event,Event.Publisher),AC.SwapView=Class.create({_view:null,currentContent:null,delegate:null,initialize:function(a){"string"==typeof a?this._viewId=a:(this._view=$(a),this._resetView())},view:function(){return this._view||(this._view=$(this._viewId),this._resetView()),this._view},_resetView:function(){if(this._view){for(var a,b=this._view.childNodes;a=b[0];)this._view.removeChild(a);this._view.addClassName("swapView")}},setDelegate:function(a){this.delegate=a},setContent:function(a){return a!==this.currentContent?(this.currentContent&&"function"==typeof this.delegate.willClose&&this.delegate.willClose(this,this.currentContent),a&&"function"==typeof this.delegate.isContentLoaded&&!this.delegate.isContentLoaded(this,a)&&"function"==typeof this.delegate.loadContent?void this.delegate.loadContent(this,a):void this.setLoadedContent(a)):void 0},setLoadedContent:function(a){"function"==typeof this.delegate.willShow&&(a=this.delegate.willShow(this,this.currentContent,a));var b,c=!0;"function"==typeof this.delegate.shouldAnimateContentChange&&(c=this.delegate.shouldAnimateContentChange(this,this.currentContent,a)),c&&"function"==typeof this.delegate.willAnimate?(this.didAnimate=!0,this.view()&&a&&this.currentContent!==a&&this.view().appendChild(a),"function"==typeof this.delegate.didAppendContent&&this.delegate.didAppendContent(this,a),b=this.delegate.willAnimate(this,this.currentContent,a,this.didShow.bind(this,a))):(this.didAnimate=!1,this.currentContent!==a&&(this.currentContent&&this.currentContent.parentNode&&this.currentContent.parentNode.removeChild(this.currentContent),a&&this.view().appendChild(a),"function"==typeof this.delegate.didAppendContent&&this.delegate.didAppendContent(this,a)),a&&$(a).setOpacity(1),this.didShow(a))},didShow:function(a){this.currentContent&&this.currentContent!==a&&this.currentContent.parentNode&&this.currentContent.parentNode.removeChild(this.currentContent),"function"==typeof this.delegate.didShow&&this.delegate.didShow(this,this.currentContent,a),this.currentContent=a}}),"undefined"==typeof AC.ViewMaster&&(AC.ViewMaster={}),AC.ViewMaster.Viewer=Class.create({view:null,triggerClassName:null,currentSection:null,requestedSection:null,sections:null,orderedSections:null,_locked:!1,_didShowInitial:!1,options:null,initialize:function(a,b,c,d){c&&(this.triggerClassName=c),this.sections=$H(),this.orderedSections=[],this.options=d||{},this.silentPreviousSelection(this.options.silentPreviousSelection),this.silentFirstSection(this.options.silentFirstSection),this.triggerEvent=this.options.triggerEvent||"click";var e,f,g=null;if(a)for(f=0;f<a.length;f++)e=this.addSection(a.item(f)),g||(g=e);this.view=new AC.SwapView(b),this.view.setDelegate(this);var h,i,j=document.location.hash;if(this.sectionRegExp=this.options.sectionRegExp||new RegExp(/#(.*)$/),i=j.match(this.sectionRegExp),i&&i[1]&&(j=i[1]),j!==this.view._viewId){var k,l=document.getElementsByClassName(this.triggerClassName);for(f=0,k;k=l[f];f++)if(k.getAttribute("href").match(new RegExp("#"+j+"(?![_w-])"))){h=this.sectionWithId(j),h&&(g=h);break}}if(!h&&"string"==typeof this.options.initialId&&this.options.initialId.length>0&&(g=this.sectionWithId(this.options.initialId)),this.show(g),this._boundTriggerClicked=this._triggerClicked.bindAsEventListener(this),"object"==typeof this.triggerEvent)for(var m,f=0;m=this.triggerEvent[f];f++)Event.observe(document,m,this._boundTriggerClicked);else Event.observe(document,this.triggerEvent,this._boundTriggerClicked);AC.Detector.isIEStrict()&&Event.observe(document,"mouseup",this._boundTriggerClicked),this.options.alwaysUseKeyboardNav===!0&&(this.options.useKeyboardNav=!0),(this.options.useKeyboardNav===!0||this.options.escapeToClose===!0)&&(this._boundKeyDown=this._keyDown.bindAsEventListener(this),Event.observe(document,"keydown",this._boundKeyDown)),this.__addEventListeners()},__addEventListeners:function(){if("function"==typeof this.listenForEvent){var a=function(a){this.stopMovieIfItsPlaying(a)}.bind(this);this.selectSectionFromEventHandler=this.selectSectionFromEvent.bind(this),this.listenForEvent(AC.ViewMaster,"ViewMasterSelectSectionWithIdNotification",!0,this.selectSectionFromEventHandler),this.listenForEvent(AC.ViewMaster,"ViewMasterWillShowNotification",!0,a),this.listenForEvent(document.event,"replayMovie",!1,this.stopMovieIfItsPlaying.bind(this)),this.options.parentSectionId&&this.listenForEvent(AC.ViewMaster,"ViewMasterWillCloseNotification",!1,function(a){var b=a.event_data.data;this!==b.sender&&b.outgoingView&&b.outgoingView.id===this.options.parentSectionId&&this.willClose(this.view,this.currentSection)})}},initialSectionFromId:function(a){return this.sectionWithId(a)},sectionWithId:function(a){if(!a)return null;var b=null;if(a&&this.sections.get(a)&&(b=this.sections.get(a)),b)return b;var c,d=null;return c=document.getElementById(a),c===this.view._view&&(c=null),c||(c=document.body.down("a."+this.triggerClassName+"[href*=#"+a+"]")),c||(d=document.getElementsByName(a),d&&d.length>0&&(c=d[0]),c===this.view._view&&(c=null)),c&&("a"===c.tagName.toLowerCase()?Element.hasClassName(c,this.triggerClassName)&&(b=this.addSection(c)):b=this.addSection(c)),b},indexOfSection:function(a){return this.orderedSections.indexOf(a.id)},selectSectionFromEvent:function(a){a.event_data.data.sender!==this&&a.event_data.data.parentTriggerClassName===this.triggerClassName&&this.selectSectionWithIdEvent(a.event_data.data.parentSectionId,a.event_data.data.event)},selectSectionWithIdEvent:function(a,b){var c,d,e=this.sectionWithId(a),f=null,g=!1;if(e){if(f=e.triggers(),f&&f.length>0)for(c=0;d=f[c];c++)if(Element.Methods.hasClassName(d,this.triggerClassName)){g=!0;break}g||(d=document.createElement("a"),d.className=this.triggerClassName,d.href="#"+a,d.style.display="none",document.body.appendChild(d),e._triggers.push(d)),this.triggerClicked(b,$(d))}},setDelegate:function(a){this.delegate=a,this.delegate&&"function"==typeof this.delegate.didShow&&this.currentSection&&this.currentSection.isContentLoaded()&&this.delegate.didShow(this,this.previousSection,this.currentSection)},createSectionForContent:function(a){return new AC.ViewMaster.Section(a,this)},addSection:function(a){var b=this.createSectionForContent(a);return this.sections.set(b.id,b),this.orderedSections.push(b.id),b},silentPreviousSelection:function(a){return"boolean"==typeof a&&(this._silentPreviousSelection=a),this._silentPreviousSelection},silentFirstSection:function(a){return"boolean"==typeof a&&(this._silentFirstSection=a),this._silentFirstSection},currentTrigger:function(){return this._currentTrigger},triggerClicked:function(a,b){b.addClassName("active"),this._currentTrigger=b,a&&this.options.silentTriggers&&Event.stop(a);var c,d=null;if(b.href.match(/#previous/)){if(d=this.getPreviousSection(),!d)return}else if(b.href.match(/#next/)){if(d=this.getNextSection(),!d)return}else{var e=b.href.match(this.sectionRegExp);c=e?e[1]:b.name,d=this.sections.get(c)}return d||(d=this.addSection(b)),d.isContentRemote()&&(d.isContentLoaded()&&b.href.match(/#previous/)&&b.href.match(/#next/)&&d.clearTrigger(b),a&&Event.stop(a)),d===this.currentSection?(a&&Event.stop(a),void("function"==typeof AC.ViewMaster.dispatchEvent&&AC.ViewMaster.dispatchEvent("ViewMasterDidShowNotification",{sender:this,outgoingView:this.previousSection,incomingView:this.currentSection,trigger:b}))):void(d&&setTimeout(this.show.bind(this,d),1))},_triggerClicked:function(a){if(!this.options.passive){var b=a.element();if(AC.Detector.isIEStrict()&&"mouseup"===a.type)b&&"A"===b.nodeName.toUpperCase()&&(b=b.down("."+this.triggerClassName));else for(;b&&"A"!==b.nodeName.toUpperCase()&&"BODY"!==b.nodeName.toUpperCase();)b=b.parentNode;if(this._silentPreviousSelection!==!0&&this._silentFirstSection!==!0&&!this._locked&&b&&b.href&&((previousSelection=b.href.toString().match(/SwapViewPreviousSelection$/))||b.href.toString().match(/SwapViewFirstSection$/))&&(b=$(b),b.hasClassName(this.triggerClassName)||b.descendantOf(this.view.view())))return Event.stop(a),void(previousSelection?this.showPreviousSelection():this.showFirst());if(b&&b.href&&Element.Methods.hasClassName(b,this.triggerClassName)){if(this._locked)return void Event.stop(a);if(this.options.parentSectionId&&"function"==typeof this.stopListeningForEvent&&"function"==typeof this.listenForEvent&&"function"==typeof AC.ViewMaster.dispatchEvent){var c=this;Event.stop(a),this.stopListeningForEvent(AC.ViewMaster,"ViewMasterSelectSectionWithIdNotification",!0,this.selectSectionFromEventHandler),this.listenForEvent(AC.ViewMaster,"ViewMasterDidShowNotification",!1,function(a){this.stopListeningForEvent(AC.ViewMaster,"ViewMasterDidShowNotification",!1,arguments.callee),c.triggerClicked(a,b),this.listenForEvent(AC.ViewMaster,"ViewMasterSelectSectionWithIdNotification",!0,this.selectSectionFromEventHandler)}),AC.ViewMaster.dispatchEvent("ViewMasterSelectSectionWithIdNotification",{sender:this,parentSectionId:this.options.parentSectionId,parentTriggerClassName:this.options.parentTriggerClassName,event:a,trigger:b})}else this.triggerClicked(a,b)}}},_keyDown:function(a){if(this._locked||a.keyCode===Event.KEY_ESC||a.keyCode===Event.KEY_LEFT||a.keyCode===Event.KEY_RIGHT){var b=a.target?a.target:a.srcElement,c=b.getAttribute("contenteditable"),d=!0;if(null==c&&(d=!1),d&&c==document.body.getAttribute("contenteditable")&&(d=!1),d&&"false"==c&&(d=!1),"input"!=b.tagName.toLowerCase()&&"textarea"!=b.tagName.toLowerCase()&&"select"!=b.tagName.toLowerCase()&&!d){var e=document.viewport.getScrollOffsets(),f=document.viewport.getHeight(),g=this.view.view(),h=g.getHeight(),i=g.cumulativeOffset()[1];if(this.options.alwaysUseKeyboardNav===!0||i>=e[1]&&Math.round(i+h/2)<e[1]+f){if(a.keyCode===Event.KEY_LEFT&&this.options.useKeyboardNav===!0){this._currentTrigger="arrow_left",this.showPrevious();var j="previous"}else if(a.keyCode===Event.KEY_RIGHT&&this.options.useKeyboardNav===!0){this._currentTrigger="arrow_right",this.showNext();var j="next"}else if(a.keyCode===Event.KEY_ESC&&this.options.escapeToClose===!0){this.currentSection.content.down('a[href="#SwapViewFirstSection"]')?(a.stop(),this._currentTrigger="esc_key",this.showFirst()):this.currentSection.content.down('a[href="#SwapViewPreviousSelection"]')&&(a.stop(),this._currentTrigger="esc_key",this.showPreviousSelection());var j="escape"}void 0!==typeof j&&(this.view._view.fire("AC.ViewMaster.Viewer:usedKeyboardNav",j),"object"==typeof this.__slideshow&&"function"==typeof this.__slideshow.userInteracted&&this.__slideshow.userInteracted())}}}},isContentLoaded:function(a,b){return b.isContentLoaded()},loadContent:function(a,b){b&&b.loadContent()},_showContentDidLoad:!1,contentDidLoad:function(a,b){b&&b.firstChild&&(this._showContentDidLoad=!0),this.view.setLoadedContent(a),AC.loadRemoteContent.insertScriptFragment(b),this.scrollSectionToVisible(a),this._showContentDidLoad&&this.delegate&&"function"==typeof this.delegate.didShow&&this.delegate.didShow(this,this.previousSection,this.currentSection),this._showContentDidLoad=!1},show:function(a,b){if(!this._locked&&(a||b)&&(this.options.alwaysShowSection||a!==this.currentSection)){if(this._locked=!0,this.delegate&&"function"==typeof this.delegate.willShowSection){var c=this.delegate.willShowSection(this,this.previousSection,a);c instanceof AC.ViewMaster.Section&&(a=c)}this.previousSection=this.currentSection,this.currentSection=a,this.disablePreviousNextIfNeeded(),this.scrollSectionToVisible(a),this.view.setContent(a)}},disablePreviousNextIfNeeded:function(){if(this.currentSection&&"undefined"!=typeof this.currentSection){var a=this.indexOfSection(this.currentSection),b=this.orderedSections.length-1,c=this.options.discontinuousPreviousNext;this.previousTriggers=this.previousTriggers?this.previousTriggers.concat($$("."+this.triggerClassName+'[href="#previous"]')).uniq():$$("."+this.triggerClassName+'[href="#previous"]'),this.previousTriggers.each(function(b){c===!0&&0===a?b.addClassName("disabled"):b.removeClassName("disabled")}),this.nextTriggers=this.nextTriggers?this.nextTriggers.concat($$("."+this.triggerClassName+'[href="#next"]')).uniq():$$("."+this.triggerClassName+'[href="#next"]'),this.nextTriggers.each(function(d){c===!0&&a===b?d.addClassName("disabled"):d.removeClassName("disabled")})}},scrollSectionToVisible:function(a){if("boolean"==typeof this.options.ensureInView&&this.options.ensureInView){if(this._didShowInitial){if(a._isContentLoaded){var b=a.content.viewportOffset()[1];(0>b||b>.75*document.viewport.getHeight())&&new Effect.ScrollTo(a.content,{duration:.3})}}else $(document.body).scrollTo();return!0}return!1},__applyOptionHeightFromFirstSection:function(){if(1==this.options.heightFromFirstSection&&!this._heightSet){var a=this.sectionWithId(this.orderedSections[0]);a&&this.setHeightFromSection(a)}},setHeightFromSection:function(a){var b=a.heightOfContent();return b>0&&(this.view.view().style.height=b+"px",this._heightSet=!0),b},__zIndex:1001,__manageZ:function(a){if(this.options.manageZ===!0||"number"==typeof this.options.manageZ){var b,c,d,e,f="";a!==!0&&(f="number"==typeof this.options.manageZ?this.options.manageZ:this.__zIndex),(e=this.view.view())&&(f=a!==!0&&(b=parseInt(e.getAttribute("data-manage-z")))&&isNaN(b)===!1?b:f,e.style.zIndex=f),this.previousSection&&this.previousSection.content&&(c=a!==!0&&(c=this.previousSection.getZIndexFromContent())?c:f,this.previousSection.content.style.zIndex=c),this.currentSection&&this.currentSection.content&&(d=a!==!0&&(d=this.currentSection.getZIndexFromContent())?d:f,this.currentSection.content.style.zIndex=d),this.delegate&&"function"==typeof this.delegate.manageZ&&this.delegate.manageZ(this,this.previousSection,this.currentSection,f,c,d)}},showFirst:function(){this.show(this.getFirstSection())},getFirstSection:function(){return this.sections.get(this.orderedSections[0])},showNext:function(){this.show(this.getNextSection())},getNextSection:function(){var a=this.indexOfSection(this.currentSection);if(this.options.discontinuousPreviousNext===!0&&a===this.orderedSections.length-1)return!1;var b=this.orderedSections.length-1===a?0:a+1;return this.sections.get(this.orderedSections[b])},showPrevious:function(){this.show(this.getPreviousSection())},getPreviousSection:function(){var a=this.indexOfSection(this.currentSection);if(this.options.discontinuousPreviousNext===!0&&0===a)return!1;var b=0===a?this.orderedSections.length-1:a-1;return this.sections.get(this.orderedSections[b])},showPreviousSelection:function(){this.show(this.getPreviousSelection())},getPreviousSelection:function(){if(this.previousSection)return this.previousSection;var a=this.orderedSections.length;for(i=0;a>i;i++)if(this.orderedSections[i]!=this.currentSection.id)return this.sections.get(this.orderedSections[i]);return!1},willShow:function(a,b,c){return this.delegate&&"function"==typeof this.delegate.willShow&&this.delegate.willShow(this,this.previousSection,this.currentSection),"function"==typeof AC.ViewMaster.dispatchEvent&&AC.ViewMaster.dispatchEvent("ViewMasterWillShowNotification",{sender:this,outgoingView:this.previousSection,incomingView:this.currentSection}),this.__manageZ(!1),this._repaintTriggers(this.previousSection,this.currentSection),this._didShowInitial&&c&&c!=this.previousSection&&($(c.content).setOpacity(0),$(c.content).removeClassName("hidden")),c?(this._addGalleryContentClassName(c.content),c.willShow(this)):null},willClose:function(a,b){this.delegate&&"function"==typeof this.delegate.willClose&&this.delegate.willClose(this,this.previousSection,this.currentSection),"function"==typeof AC.ViewMaster.dispatchEvent&&AC.ViewMaster.dispatchEvent("ViewMasterWillCloseNotification",{sender:this,outgoingView:b}),this.previousSection&&this.previousSection.willClose(this)},shouldAnimateContentChange:function(){var a=!0;return a=this.delegate&&"function"==typeof this.delegate.shouldAnimateContentChange?this.delegate.shouldAnimateContentChange(this,this.previousSection,this.currentSection):"boolean"==typeof this.options.shouldAnimateContentChange?this.options.shouldAnimateContentChange:!0,"boolean"==typeof a?a:!0},willAnimate:function(a,b,c,d){var e=this.options.animationDuration||.4,f=Math.random()+"Queue";return this._didShowInitial||"function"!=typeof d?this.delegate&&"function"==typeof this.delegate.willAnimate?this.delegate.willAnimate(this,b,c,d,f,e):this.options.shouldAnimateOpacityAndHeight?this._animationPlusHeight(a,b,c,d,f,e):this._animation(a,b,c,d,f,e):void d()},_animation:function(a,b,c,d,e,f){var g=a.view(),h=this;g&&(g.style.position="relative"),b&&(b.style.position="absolute"),c&&(c.style.position="absolute");var i=function(){g&&(g.style.position=""),b&&(b.style.position=""),c&&(c.style.position=""),d()};if(!AC.Detector.isCSSAvailable("transition"))return b&&h.options.shouldAnimateFadeIn!==!0?new Effect.Parallel([new Effect.Opacity(b,{sync:!0,from:1,to:0}),new Effect.Opacity(c,{sync:!0,from:0,to:1})],{duration:f,afterFinish:i,queue:{scope:e}}):new Effect.Opacity(c,{from:0,to:1,duration:f,afterFinish:i,queue:{scope:e}});c&&(c.setOpacity(0),c.setVendorPrefixStyle("transition","opacity "+f+"s")),b&&h.options.shouldAnimateFadeIn!==!0&&(b.setOpacity(1),b.setVendorPrefixStyle("transition","opacity "+f+"s")),window.setTimeout(function(){c&&c.setOpacity(1),b&&h.options.shouldAnimateFadeIn!==!0&&b.setOpacity(0)},100);var j=function(a){a.target==c&&"opacity"==a.propertyName&&(c.removeVendorEventListener("transitionEnd",j,!1),i())};c&&c.addVendorEventListener("transitionEnd",j,!1)},_animationPlusHeight:function(a,b,c,d,e,f){var g=a.view(),h=c.offsetHeight||1,i=g.offsetHeight||1,j=h/i*100;g&&(g.style.position="relative"),b&&(b.style.position="absolute"),c&&(c.style.position="absolute");var k=function(){g&&(g.style.position=""),b&&(b.style.position=""),c&&(c.style.position=""),d()};if(!AC.Detector.isCSSAvailable("transition"))return b?new Effect.Parallel([new Effect.Opacity(b,{sync:!0,from:1,to:0}),new Effect.Opacity(c,{sync:!0,from:0,to:1}),new Effect.Scale(g,j,{scaleMode:{originalHeight:i,originalWidth:g.offsetWidth},sync:!0,scaleX:!1,scaleContent:!1})],{duration:f,afterFinish:k,queue:{scope:e}}):new Effect.Parallel([new Effect.Opacity(c,{sync:!0,from:0,to:1}),new Effect.Scale(g,j,{scaleMode:{originalHeight:i,originalWidth:g.offsetWidth},sync:!0,scaleX:!1,scaleContent:!1})],{duration:f,afterFinish:k,queue:{scope:e}});c.setOpacity(0),c.setVendorPrefixStyle("transition","opacity "+f+"s"),b&&b.setOpacity(0),window.setTimeout(function(){c.setOpacity(1)},100),AC.Detector.isiPad()||AC.Detector.isMobile()||g.setVendorPrefixStyle("transition","height "+f+"s"),g.style.height=h+"px";var l=function(a){a.target==c&&"opacity"==a.propertyName&&(c.removeVendorEventListener("transitionEnd",l,!1),k())};c.addVendorEventListener("transitionEnd",l,!1)},didAppendContent:function(a,b){this.delegate&&"function"==typeof this.delegate.didAppendContent&&this.delegate.didAppendContent(this,b),this.__applyOptionHeightFromFirstSection()},hideSwapViewLinks:function(a){var b=this.getPreviousSelection();if(!b||this._silentPreviousSelection===!0){var c=a.select('a[href$="SwapViewPreviousSelection"]');if(c.length>0){this._previousSectionLinks||(this._previousSectionLinks=[]);for(var d=c.length-1;d>=0;d--)c[d].style.display="none",this._previousSectionLinks.push(c[d])}}if(b&&this._silentPreviousSelection!==!0&&this._previousSectionLinks&&this._previousSectionLinks.length>0)for(var d=this._previousSectionLinks.length-1;d>=0;d--)this._previousSectionLinks[d].style.display="",this._previousSectionLinks.splice(d,1);var b=this.getFirstSection();if(!b||b==this.currentSection||this._silentFirstSection===!0){var c=a.select('a[href$="SwapViewFirstSection"]');if(c.length>0){this._firstSectionLinks||(this._firstSectionLinks=[]);for(var d=c.length-1;d>=0;d--)c[d].style.display="none",this._firstSectionLinks.push(c[d])}}if(b&&b!==this.currentSection&&this._silentFirstSection!==!0&&this._firstSectionLinks&&this._firstSectionLinks.length>0)for(var d=this._firstSectionLinks.length-1;d>=0;d--)this._firstSectionLinks[d].style.display="",this._firstSectionLinks.splice(d,1)},stopMovieIfItsPlaying:function(a){if(AC.ViewMaster.Viewer.allowMultipleVideos()!==!0){if(a.event_data.data.incomingView)var b=a.event_data.data.sender,c=a.event_data.data.incomingView,d=!1;else var b=this,c=a.event_data.data,d=!0;(b!=this||d)&&this.currentSection&&this.currentSection.hasMovie()&&c&&("function"==typeof c.hasMovie&&c.hasMovie()||c.content&&c.content.getElementsByClassName("movieLink")[0])&&(this.options.showPreviousOnStopMovie&&this.getPreviousSelection()?this.showPreviousSelection():this.options.showFirstOnStopMovie&&this.getFirstSection()?this.showFirst():this.currentSection.stopMovie())}},didShow:function(a,b,c){c&&(this._addGalleryContentClassName(c.content),this.hideSwapViewLinks(c)),this.__manageZ(!0),this.currentSection&&this.currentSection.didShow(this),this._didShowInitial=!0,this._locked=!1,this.options.shouldAnimateOpacityAndHeight&&window.setTimeout(function(){var b=a.view(),d=c.offsetHeight||0;b.style.height=d+"px"},35),!this._showContentDidLoad&&this.delegate&&"function"==typeof this.delegate.didShow&&this.delegate.didShow(this,this.previousSection,this.currentSection),"function"==typeof AC.ViewMaster.dispatchEvent&&AC.ViewMaster.dispatchEvent("ViewMasterDidShowNotification",{sender:this,outgoingView:this.previousSection,incomingView:this.currentSection,trigger:this._currentTrigger})},_repaintTriggers:function(a,b){if(a){for(var c,d=a.triggers(),e=0;c=d[e];e++)c.removeClassName("active");d=a.relatedElements();for(var c,e=0;c=d[e];e++)c.removeClassName("active")}if(b){for(var c,f=b.triggers(),e=0;c=f[e];e++)c.addClassName("active");f=b.relatedElements();for(var c,e=0;c=f[e];e++)c.addClassName("active")}},_addGalleryContentClassName:function(a){this.options.addGalleryContentClassName===!0&&a&&Object.isElement(a)&&a.addClassName("gallery-content")}}),AC.ViewMaster.Viewer.allowMultipleVideos=function(a){return"boolean"==typeof a&&(this._allowMultipleVideos=a),this._allowMultipleVideos},Event.Publisher&&Object.extend(AC.ViewMaster,Event.Publisher),Event.Listener&&Object.extend(AC.ViewMaster.Viewer.prototype,Event.Listener),AC.ViewMaster.Section=Class.create({content:null,moviePanel:null,controllerPanel:null,movie:null,_movieController:null,movieLink:null,endState:null,hasShown:!1,_isContentRemote:!1,isContentRemote:function(){return this._isContentRemote},_isContentLoaded:!0,isContentLoaded:function(){return this._isContentLoaded},_onMoviePlayable:Prototype.EmptyFunction,_onMovieFinished:Prototype.EmptyFunction,id:null,triggers:function(){if(!this._triggers){this._triggers=[];var a=new RegExp("#"+this.id+"$");(this.viewMaster.sectionRegExp||this.viewMaster.options.sectionRegExp)&&(a=this.viewMaster.sectionRegExp||this.viewMaster.options.sectionRegExp,a=a.toString().replace(/^\//,"").replace(/\/$/,""),a=new RegExp(a.replace("(.*)",this.id)));for(var b,c=document.getElementsByClassName(this.viewMaster.triggerClassName),d=0;b=$(c[d]);d++)"a"===b.tagName.toLowerCase()&&b.href.match(a)&&this._triggers.push(b);for(var b,e=this.content.getElementsByClassName(this.viewMaster.triggerClassName),d=0;b=$(e[d]);d++)"a"===b.tagName.toLowerCase()&&b.href.match(a)&&this._triggers.push(b)}return this._triggers},relatedElements:function(){return this._relatedElements||(this._relatedElements=document.getElementsByClassName(this.id)),this._relatedElements},initialize:function(a,b){if(this.content=$(a),"a"===this.content.tagName.toLowerCase()){var c=this.content.getAttribute("href"),d=c.split("#");this._contentURL=d[0];var e=window.location.href.split("#"),f=(a.className,document.getElementsByTagName("base")[0]),g=f?f.href:null;if(2===d.length&&(this.id=d[1]),!(this._contentURL.length>0)||g&&this._contentURL==g||this._contentURL===e[0]||this._contentURL.startsWith("#")&&this._contentURL===c){var h=$(this.id)||$("MASKED-"+this.id);h&&(this.content=h)}else this._isContentRemote=!0,this._isContentLoaded=!1;this.id||(this.id=this.content.name)}else this.id=a.id;if((!this._isContentRemote||this._isContentLoaded)&&this.content.setAttribute("id","MASKED-"+this.id),b&&(this.viewMaster=b),!this._isContentRemote&&this._isContentLoaded&&!this.content.hasClassName("content")){var i=this.content.getElementsByClassName("content")[0];i&&(this.content=i)}this.isMobile=AC.Detector.isMobile()},clearTrigger:function(a){a.href!=="#"+this.id&&(a.href="#"+this.id,a.removeAttribute("id"),a.removeAttribute("name"),this.viewMaster.options.silentTriggers||(document.location.hash=this.id))},remoteContentDidLoad:function(a,b){this.clearTrigger(this.content),this.content=$(a),this.content.setAttribute("id","MASKED-"+this.id),this._isContentLoaded=!0,this.viewMaster.contentDidLoad(this,b)},loadContent:function(){if(this._isContentLoaded){var a=this;a.viewMaster.contentDidLoad(a,null)}else if(-1!==this.content.className.indexOf("imageLink")){var b=document.createElement(this.viewMaster.options.useHTML5Tags?"figure":"div");if(this.viewMaster.options.imageLinkClasses){try{console.warn('"imageLinkClasses" is deprecated. Use "addSectionIdAsClassName" instead.')}catch(c){}Element.addClassName(b,this.id)}if(b.appendChild(this.content.cloneNode(!0)),this.viewMaster.options.imageLinkAutoCaptions){var d="string"==typeof this.viewMaster.options.imageLinkAutoCaptions?this.viewMaster.options.imageLinkAutoCaptions:"title";if(this.content.hasAttribute(d)){if(this.viewMaster.options.useHTML5Tags)var e=document.createElement("figcaption");else{var e=document.createElement("p");Element.addClassName(e,"caption")}e.innerHTML=this.content.getAttribute(d),Element.insert(b,e)}}this.remoteContentDidLoad(b)}else if(-1!==this.content.className.indexOf("movieLink")||-1!==this.content.className.indexOf("audioLink")){var b=document.createElement(this.viewMaster.options.useHTML5Tags?"figure":"div");b.appendChild(this.content.cloneNode(!0)),this.remoteContentDidLoad(b)}else AC.loadRemoteContent(this._contentURL,!0,!0,this.remoteContentDidLoad.bind(this),null,this)},shouldImportScriptForContentURL:function(a){var b=!1;return a.hasAttribute?b=a.hasAttribute("src"):(src=a.getAttribute("src"),b=null!=src&&""!==src),b?!0:(scriptText=a.text,-1!==scriptText.search(/.*\.location\.replace\(.*\).*/)?!1:!0)},mediaType:function(){return this.movieLink?"video/quicktime":"text/html"},willClose:function(){this._closeController(),this._closeMovie()},willShow:function(){if(!this.hasShown){this.hasShown=!0,this.viewMaster.options.addSectionIdAsClassName===!0&&this.content.addClassName(this.id);for(var a=this.content.getElementsByClassName("imageLink"),b=0;b<a.length;b++)this._loadImage(a[b]);this.moviePanel||(this.movieLink=this.content.getElementsByClassName("movieLink")[0],this.movieLink&&(this.posterLink=this.__getPoster(this.content,this.movieLink),this._loadMovie()))}return this.content},__getPoster:function(a,b){var c;if(b&&b.hasAttribute("data-poster"))c=b.readAttribute("data-poster");else{var c=a.getElementsByClassName("posterLink")[0];c&&(c=c.href)}return c},_heightOfContent:0,heightOfContent:function(){return 0!==this._heightOfContent||this._isContentRemote&&!this._isContentLoaded||(this.content.parentNode?this._heightOfContent=this.content.getOuterDimensions().height:(this.content.style.visibility="hidden",this.viewMaster.view.view().appendChild(this.content),this._heightOfContent=this.content.getOuterDimensions().height,this.viewMaster.view.view().removeChild(this.content),this.content.style.visibility="")),this._heightOfContent},getZIndexFromContent:function(){return this.content?parseInt(this.content.getAttribute("data-manage-z"))||null:null},didShow:function(){var a=this.hasMovie()&&!this.isMobile,b=this.isACMediaAvailable();b?a?(this._movieControls=this.newMovieController(),this._playMovie(),this._movieController?(this._movieController.setControlPanel(this._movieControls),this.onMovieFinished=this.didFinishMovie.bind(this),this._movieController.setDelegate(this)):this.controllerPanel.innerHTML=""):this._playMovie():(a&&(this._movieController=this.newMovieController(),this.controllerPanel.innerHTML="",this.controllerPanel.appendChild(this._movieController.render())),this._playMovie(),a&&(this._onMoviePlayable=this._movieController.monitorMovie.bind(this._movieController),this._onMovieFinished=this.didFinishMovie.bind(this),this._movieController.attachToMovie(this.movie,{onMoviePlayable:this._onMoviePlayable,onMovieFinished:this._onMovieFinished})))},defaultMovieWidth:function(){return 848},defaultMovieHeight:function(){return 480},defaultOptions:function(){return{width:this.defaultMovieWidth(),height:this.defaultMovieHeight(),controller:!1,posterFrame:null,showlogo:!1,autostart:!0,cache:!0,bgcolor:"white",aggressiveCleanup:!1}},_forceACQuicktime:!1,isACMediaAvailable:function(){return"undefined"!=typeof Media&&this._forceACQuicktime===!1},setShouldForceACQuicktime:function(a){this._forceACQuicktime=a},movieControls:function(){return this._movieControls},newMovieController:function(){return this.isACMediaAvailable()?this._movieControls||new Media.ControlsWidget(this.controllerPanel):new AC.QuicktimeController},_loadImage:function(a){var b=document.createElement("img");"about:"===a.protocol&&(a.href="/"+a.pathname,a.href=a.href.replace(/^\/blank/,"")),b.setAttribute("src",a.href),this.viewMaster.options.imageLinkAutoCaptions?b.setAttribute("alt",""):b.setAttribute("alt",a.title),a.parentNode.replaceChild(b,a)},_loadMovie:function(){var a=this.isACMediaAvailable();if(this.moviePanel=$(document.createElement("div")),this.moviePanel.addClassName("moviePanel"),this.movieLink.parentNode.replaceChild(this.moviePanel,this.movieLink),this.controllerPanel=$(document.createElement("div")),this.controllerPanel.addClassName("controllerPanel"),a===!1||this.moviePanel.appendChild(this.controllerPanel),a===!1?this.moviePanel.parentNode.insertBefore(this.controllerPanel,this.moviePanel.nextSibling):this.moviePanel.appendChild(this.controllerPanel),this.endState=$(this.content.getElementsByClassName("endState")[0]),this.endState){this.endState.parentNode.removeChild(this.endState);var b=$(this.endState.getElementsByClassName("replay")[0]);b&&b.observe("click",function(a){Event.stop(a),this.replayMovie()}.bindAsEventListener(this))}},_playMovie:function(a){if(this.movieLink&&this.moviePanel){var b=this.isACMediaAvailable();if(b?(this.movie&&this.movie.parentNode==this.moviePanel&&(this.moviePanel.removeChild(this.movie),this.controllerPanel.hide()),this.endState&&this.endState.parentNode==this.moviePanel&&this.moviePanel.removeChild(this.endState),this.controllerPanel&&Element.hasClassName(this.controllerPanel,"inactive")&&(this.controllerPanel.show(),Element.removeClassName(this.controllerPanel,"inactive"))):this.moviePanel.innerHTML="",this.posterLink&&this.posterLink.length>0)var c=this.posterLink;var d,e=this.movieLink.getAttribute("href",2).toQueryParams(),f=this.defaultOptions();1==a&&(e.replay=!0),f.posterFrame=c,d=Object.extend(f,e);for(opt in d)d[opt]="true"===d[opt]?!0:"false"===d[opt]?!1:d[opt];b===!0?(this._movieController=Media.create(this.moviePanel,this.movieLink.getAttribute("href",2),d),this._movieController&&(this.movie=this._movieController.video().object())):(this.movie=AC.Quicktime.packageMovie(this.movieLink.id+"movieId",this.movieLink.getAttribute("href",2),d,this.moviePanel),AC.Quicktime.movieIsFlash||this.moviePanel.appendChild(this.movie)),b===!0&&!this.isMobile&&this.movie&&(this._movieControls.reset(),this.moviePanel.appendChild(this.controllerPanel)),"function"==typeof document.event.dispatchEvent&&document.event.dispatchEvent("didStart",this)}},replayMovie:function(){var a=this.isACMediaAvailable();"function"==typeof document.event.dispatchEvent&&document.event.dispatchEvent("replayMovie",this),a&&this.moviePanel&&this.endState&&this.moviePanel.removeChild(this.endState),this._playMovie(!0),a&&this.controllerPanel.show(),this.controllerPanel.removeClassName("inactive"),a?(this._movieController.setControlPanel(this._movieControls),this._movieController.setDelegate(this)):(this.controllerPanel.stopObserving("click",this._movieController.replay),this._movieController.replay=null,this._movieController.attachToMovie(this.movie,{onMoviePlayable:this._onMoviePlayable,onMovieFinished:this._onMovieFinished}))
},stopMovie:function(){this.hasMovie()&&(this._closeController(),this._closeMovie(),this.viewMaster.options.showPreviousOnStopMovie&&this.viewMaster.getPreviousSelection()?this.viewMaster.showPreviousSelection():this.viewMaster.options.showFirstOnStopMovie&&this.viewMaster.getFirstSection()?this.viewMaster.showFirst():this.endState?this.moviePanel.appendChild(this.endState):this.stopMovieWithNoEndState())},stopMovieWithNoEndState:function(){var a=this;setTimeout(function(){a.viewMaster.showPreviousSelection()},0)},_closeMovie:function(){this.movie&&this.moviePanel&&(this.isACMediaAvailable()?(AC.Detector.isIEStrict()?(this.moviePanel.removeChild(this.movie),this.controllerPanel.hide()):this.moviePanel.innerHTML="",this.movie=null):(this.moviePanel.removeChild(this.movie),this.movie=null,this.moviePanel.innerHTML=""))},_closeController:function(){this.isACMediaAvailable()?this._movieController&&this.hasMovie()&&!this.isMobile&&(this._movieController.stop(),this._movieController.setControlPanel(null),AC.Detector.isIEStrict()&&this.controllerPanel.hide(),this.controllerPanel.addClassName("inactive")):this._movieController&&this._movieController.movie&&this.hasMovie()&&!this.isMobile&&(this._movieController.Stop(),this._movieController.detachFromMovie(),this.controllerPanel.addClassName("inactive"),this._movieController.replay=this.replayMovie.bind(this),this.controllerPanel.observe("click",this._movieController.replay))},hasMovie:function(){return!!this.movieLink},isMoviePlaying:function(){if(this._movieController){if("function"==typeof this._movieController.playing)return this._movieController.playing();if("boolean"==typeof this._movieController.playing)return this._movieController.playing}return!1},didFinishMovie:function(){if(this.hasMovie()){"function"==typeof document.event.dispatchEvent&&document.event.dispatchEvent("didFinishMovie",this);var a=this;window.setTimeout(function(){a.stopMovie.apply(a)},0)}}}),AC.ViewMaster.Slideshow=Class.create(),Event.Listener&&Object.extend(AC.ViewMaster.Slideshow.prototype,Event.Listener),Event.Publisher&&Object.extend(AC.ViewMaster.Slideshow.prototype,Event.Publisher),Object.extend(AC.ViewMaster.Slideshow.prototype,{contentController:null,animationTimeout:null,options:null,_playing:!1,_active:!1,_progress:0,setProgress:function(a){this._progress=a},progress:function(){return this._progress},initialize:function(a,b,c){this.contentController=a,this.contentController.__slideshow=this,this.triggerClassName=b,this.options=c||{},this.options.stopOnContentTriggerClick===!0&&this.contentController.options.useTouchEvents===!0&&(this.options.stopOnUserInteraction=this.options.stopOnContentTriggerClick),this.options.addNoListeners||(this.listenForEvent(AC.ViewMaster,"ViewMasterWillShowNotification",!0,this.willShow),this.listenForEvent(AC.ViewMaster,"ViewMasterDidShowNotification",!0,this.didShow)),this.options.autoplay&&(this.options.autoplay===!0?this.start():"number"==typeof this.options.autoplay&&(this.toAutoplay=window.setTimeout(function(){this.start()}.bind(this),this.options.autoplay))),Event.observe(document,"click",this._triggerHandler.bindAsEventListener(this));var d=this.contentController.view.view();Event.observe(d,"AC.ViewMaster.Slideshow:play",this.play.bindAsEventListener(this)),Event.observe(d,"AC.ViewMaster.Slideshow:stop",this.stop.bindAsEventListener(this))},start:function(){this._active||(this._active=!0,("always"==this.options.wipeProgress||"on start"==this.options.wipeProgress)&&(this._progress=0),this.play(!0),this._repaintTriggers(),"function"==typeof document.event.dispatchEvent&&document.event.dispatchEvent("didStart",this))},stop:function(){this._active=!1,this.pause(),this._repaintTriggers(),this.toAutoplay&&(window.clearTimeout(this.toAutoplay),delete this.toAutoplay),"function"==typeof document.event.dispatchEvent&&document.event.dispatchEvent("didEnd",this)},play:function(a){this._active&&(("always"==this.options.wipeProgress||"on play"==this.options.wipeProgress&&!a)&&(this._progress=0),this.animationTimeout=setTimeout(this._update.bind(this),this._heartbeatDelay()),this._playing=!0)},_update:function(){"function"==typeof this.options.onProgress&&this.options.onProgress(this._progress,this.delay()),this._progress>=this.delay()?(this._progress=0,this.next()):(this._progress+=this._heartbeatDelay(),this.animationTimeout=setTimeout(this._update.bind(this),this._heartbeatDelay()))},delay:function(){return this.options.delay||5e3},_heartbeatDelay:function(){return this.options.heartbeatDelay||100},pause:function(){clearTimeout(this.animationTimeout),this._playing=!1},next:function(){var a=this.contentController.options.discontinuousPreviousNext;this.options.discontinuousPreviousNext!==a&&(this.contentController.options.discontinuousPreviousNext=this.options.discontinuousPreviousNext);var b="number"==typeof this.options.stopAfterReturnToSection&&this.contentController.indexOfSection(this.contentController.currentSection)==this.options.stopAfterReturnToSection||"string"==typeof this.options.stopAfterReturnToSection&&this.contentController.currentSection.id==this.options.stopAfterReturnToSection,c=this.options.willEnd&&this.contentController.getNextSection()==this.contentController.getFirstSection();if(b||c){if(c)try{console.warn("Instead of AC.ViewMaster.Slideshow.options.willEnd = true, please use AC.ViewMaster.Viewer.options.discontinuousPreviousNext = true.")}catch(d){}this._returnedToSection||c?this.stop():this._returnedToSection||(this._returnedToSection=!0)}this._active&&this.contentController.showNext(),this.contentController.options.discontinuousPreviousNext=a,this.contentController.disablePreviousNextIfNeeded()},previous:function(){this.contentController.showPrevious()},reset:function(){this.contentController.showFirst(),this.setProgress(0)},willShow:function(a){a.event_data.data.sender==this.contentController&&this.pause()},didShow:function(a){a.event_data.data.sender==this.contentController&&this.play()},_triggerHandler:function(a){var b=a.element();if((this.options.stopOnUserInteraction===!0||this.options.stopOnContentTriggerClick)&&(link=a.findElement("a"))&&link.hasClassName(this.contentController.triggerClassName)&&-1==link.href.search(this.contentController.currentSection.id))if(this.options.stopOnContentTriggerClick){try{console.warn('"stopOnContentTriggerClick" is deprecated. Please use "stopOnUserInteraction" instead.')}catch(c){}this.stop()}else this.userInteracted();else b.hasClassName(this.triggerClassName)&&b.href.match(/#slideshow-toggle/)&&(Event.stop(a),this._active?this.stop():this.start())},userInteracted:function(){this.options.stopOnUserInteraction===!0&&this.stop()},_repaintTriggers:function(){if(this.triggerClassName)for(var a=document.getElementsByClassName(this.triggerClassName),b=a.length-1;b>=0;b--)this._repaintTrigger(a[b])},_repaintTrigger:function(a){var b=$(a);this._active?b.addClassName("playing"):b.removeClassName("playing")}}),AC.SlideView=Class.create(AC.SwapView,{_resetView:function(){this._view&&this._view.addClassName("swapView")},setLoadedContent:function(a){"function"==typeof this.delegate.willShow&&(a=this.delegate.willShow(this,this.currentContent,a));var b,c=!0;"function"==typeof this.delegate.shouldAnimateContentChange&&(c=this.delegate.shouldAnimateContentChange(this,this.currentContent,a)),c&&"function"==typeof this.delegate.willAnimate?(this.didAnimate=!0,"function"==typeof this.delegate.didAppendContent&&this.delegate.didAppendContent(this,a),b=this.delegate.willAnimate(this,this.currentContent,a,this.didShow.bind(this,a))):(this.didAnimate=!1,this.currentContent!==a&&"function"==typeof this.delegate.didAppendContent&&this.delegate.didAppendContent(this,a),a&&$(a).setOpacity(1),this.didShow(a))},didShow:function(a){"function"==typeof this.delegate.didShow&&this.delegate.didShow(this,this.currentContent,a),this.currentContent=a}}),AC.ViewMaster.SlideViewer=Class.create(AC.ViewMaster.Viewer,{initialize:function(a,b,c,d){c&&(this.triggerClassName=c),this.sections=$H(),this.orderedSections=[],this.options=d||{},this.silentPreviousSelection(this.options.silentPreviousSelection),this.silentFirstSection(this.options.silentFirstSection),this.triggerEvent=this.options.triggerEvent||"click";var e,f,g=null;if(a)for(f=0;f<a.length;f++)e=this.addSection(a.item(f)),g||(g=e);this.view=new AC.SlideView(b),this.view.setDelegate(this),this.__mask=this.view.view().up();var h,i,j=document.location.hash;if(this.sectionRegExp=this.options.sectionRegExp||new RegExp(/#(.*)$/),i=j.match(this.sectionRegExp),i&&i[1]&&(j=i[1]),j!==this.view._viewId){var k,l=document.getElementsByClassName(this.triggerClassName);for(f=0,k;k=l[f];f++)if(k.getAttribute("href").match(new RegExp("#"+j+"(?![_w-])"))){h=this.sectionWithId(j),h&&(g=h);break}}if(!h&&"string"==typeof this.options.initialId&&this.options.initialId.length>0&&(g=this.sectionWithId(this.options.initialId)),this.show(g),this._boundTriggerClicked=this._triggerClicked.bindAsEventListener(this),"object"==typeof this.triggerEvent)for(var m,f=0;m=this.triggerEvent[f];f++)Event.observe(document,m,this._boundTriggerClicked);else Event.observe(document,this.triggerEvent,this._boundTriggerClicked);AC.Detector.isIEStrict()&&Event.observe(document,"mouseup",this._boundTriggerClicked),(this.options.useKeyboardNav===!0||this.options.escapeToClose===!0)&&(this._boundKeyDown=this._keyDown.bindAsEventListener(this),Event.observe(document,"keydown",this._boundKeyDown)),this.options.useTouchEvents===!0&&"undefined"!=typeof window.ontouchstart&&this.__touchLoadEventDependencies(),this.__addEventListeners(),this._addGalleryContentClassNameToAllSections()},__touchLoadEventDependencies:function(){if("function"==typeof Element.trackTouches)this.__touchInitTrackTouches();else{if(null===$("swap-view-track-touches-script-tag")){var a=document.getElementsByTagName("head")[0],b=document.createElement("script");b.type="text/javascript",b.setAttribute("src","http://images.apple.com/global/scripts/pagingview.js"),b.setAttribute("id","swap-view-track-touches-script-tag"),a.appendChild(b)}this.__boundTouchInitTrackTouches=this.__touchInitTrackTouches.bindAsEventListener(this),document.observe("ac:trackTouches:load",this.__boundTouchInitTrackTouches)}},__touchInitTrackTouches:function(){this.options.discontinuousPreviousNext=!0,this.options.continuous=!1,this._shouldBeContinuous=!1,this.__boundTouchTrackEvents=this.__touchTrackEvents.bindAsEventListener(this),this.__maskWidth=this.__mask.getWidth()||0,this.view.view().trackTouches(this.__boundTouchTrackEvents,this.__boundTouchTrackEvents,this.__boundTouchTrackEvents,{stopEvent:"horizontal",stopThreshold:10})},__touchTrackEvents:function(a){var b=this.view.view();b.setVendorPrefixStyle("transition-duration","0"),a.startCoords&&a.coords&&(a.difference&&"undefined"!=typeof this.__touchTrackedStartOffset?b.setVendorPrefixTransform(this.__touchTrackingNewLeft(a)+"px"):this.__touchStart(a),0===a.touches.length&&this.__touchEnd(a))},__touchStart:function(){var a,b=this.view.view();this.__storedShouldAnimateContentChange=this.options.shouldAnimateContentChange,this.options.shouldAnimateContentChange=!1,"undefined"!=typeof this.__touchAnimateAfterTouchEnd&&this.__touchAnimateAfterTouchEnd(!1),a=b.translateOffset(),this.__touchTrackedStartOffset=null===a||"object"!=typeof a?0:a.x},__touchEnd:function(a){var b,c,d=this.view.view(),e=a.difference.abs.x/this.__maskWidth,f=a.difference.current.x/this.__maskWidth,g=this.options.animationDuration||.4;(f>.4||a.speed>=7)&&("right"===a.direction.x?b=this.getNextSection():"left"===a.direction.x&&(b=this.getPreviousSection())),this.__touchSetTransitionEnd(d,b),b===!1||"undefined"==typeof b?this._animate(this.__touchTrackedStartOffset,g*e):(c=-1*b.content.positionedOffset()[0],e>=.5&&(g*=.5),this._animate(c,g)),a.difference.abs.x>5&&"object"==typeof this.__slideshow&&"function"==typeof this.__slideshow.userInteracted&&this.__slideshow.userInteracted(),delete this.__touchTrackedStartOffset},__touchSetTransitionEnd:function(a,b){var c=function(c){c!==!1&&this.show(b),this.options.shouldAnimateContentChange=this.__storedShouldAnimateContentChange,delete this.__storedShouldAnimateContentChange,a.removeVendorEventListener("transitionEnd",this.__touchAnimateAfterTouchEnd,!1),delete this.__touchAnimateAfterTouchEnd};this.__touchAnimateAfterTouchEnd=c.bindAsEventListener(this),a.addVendorEventListener("transitionEnd",this.__touchAnimateAfterTouchEnd,!1)},__touchTrackingNewLeft:function(a){var b,c,d=this.isAtEnd(this.currentSection);return b=function(a,b){var c,d,e;return c=function(a){return 1==a?1:1-Math.pow(2,-3*a)},e=a/b,d=parseFloat(c(e)*(b/3))},d!==!1&&"left"===d&&a.difference.x<0||"right"===d&&a.difference.x>0?(c=b(a.difference.abs.x,this.__maskWidth),"left"===d&&(c*=-1)):c=a.difference.x,this.__touchTrackedStartOffset-c},isAtEnd:function(a){var b=this.orderedSections.indexOf(a.id);return 0===b?"left":b===this.orderedSections.length-1?"right":!1},getNextSection:function(a){return this.options.continuous&&(this._shouldBeContinuous=!0),a()},getPreviousSection:function(a){return this.options.continuous&&(this._shouldBeContinuous=!0),a()},willShow:function(a,b,c,d){return this.options.shouldAddActiveClassToContent===!0&&(c&&c.removeClassName("active"),d&&d.content.addClassName("active")),a(b,c,d)},__fixScrollLeft:function(a){(void 0===this.__fixScrollLeftCounter||a&&a.type&&"load"===a.type)&&(this.__fixScrollLeftCounter=0),(0!==this.__mask.scrollLeft||this.__fixScrollLeftCounter<5)&&(this.__mask.scrollLeft=0,this.__fixScrollLeftCounter++,window.setTimeout(this.__boundFixScrollLeft,10))},willAnimate:function(a,b,c,d,e){this.__boundFixScrollLeft=this.__fixScrollLeft.bind(this),window.setTimeout(this.__boundFixScrollLeft,50),Event.observe(window,"load",this.__boundFixScrollLeft);var f=b.view().offsetLeft||0,g=-d.offsetLeft||0;f!==g?(this._didShowInitial=!0,a(b,c,d,e),this._didShowInitial=!1):a(b,c,d,e),this.willAnimate=a},_animate:function(a,b){var c=this.view.view();0==b?c.setVendorPrefixStyle("transition","none"):c.setVendorPrefixStyle("transition","-webkit-transform "+b+"s cubic-bezier(0,0,0.25,1)"),c.setAttribute("left",a),AC.Detector.supportsThreeD()?c.setVendorPrefixStyle("transform","translate3d("+a+"px, 0, 0)"):c.setVendorPrefixStyle("transform","translate("+a+"px, 0)")},_animation:function(a,b,c,d,e,f){var g=a.view(),h=g.offsetLeft||0,i=-c.offsetLeft||0;if(c.setOpacity(1),this._shouldBeContinuous){var j=this.indexOfSection(a.delegate.currentSection),k=this.indexOfSection(a.delegate.previousSection),l=i;0===j&&k===this.orderedSections.length-1?(i=-1*(b.positionedOffset()[0]+b.getWidth()),this._continuousCloneElement=this._continuousClone(a,c,i)):j===this.orderedSections.length-1&&0===k&&(i=-1*(b.positionedOffset()[0]-b.getWidth()),this._continuousCloneElement=this._continuousClone(a,c,i))}var m=this;if(!AC.Detector.isCSSAvailable("transition")||!AC.Detector.isCSSAvailable("transform"))return new Effect.Move(g,{x:i-h,y:0,duration:f,afterFinish:function(){m._continuousReset(l,a),d()},queue:{scope:e}});this._animate(i,f);var n=function(b){b.target==g&&b.propertyName.match(/transform$/i)&&(g.removeVendorEventListener("transitionEnd",n,!1),m._continuousReset(l,a),d())};g.addVendorEventListener("transitionEnd",n,!1)},_continuousClone:function(a,b,c){if(this._shouldBeContinuous){var d=b.cloneNode(!0);return d.id=d.id+"-clone",d.innerHTML=b.innerHTML,d.setStyle("position: absolute; top: 0; left:"+-1*c+"px"),a._view.insert(d),d}return!1},_continuousReset:function(a,b){this._shouldBeContinuous&&(b._view.setAttribute("left",a),AC.Detector.isCSSAvailable("transition")&&AC.Detector.isCSSAvailable("transform")?(b._view.setVendorPrefixStyle("transition","none"),AC.Detector.supportsThreeD()?b._view.setVendorPrefixStyle("transform","translate3d("+a+"px, 0, 0)"):b._view.setVendorPrefixStyle("transform","translate("+a+"px, 0)")):b._view.setStyle("left:"+a+"px"),delete this._shouldBeContinuous),this._continuousCloneElement&&(this._removeContinuousCloneElement?(this._continuousCloneElement.remove(),delete this._continuousCloneElement,delete this._removeContinuousCloneElement):this._removeContinuousCloneElement=!0)},_addGalleryContentClassNameToAllSections:function(){if(this.options.addGalleryContentClassName===!0){var a;for(a=0;a<this.orderedSections.length;a++)this._addGalleryContentClassName(this.sectionWithId(this.orderedSections[a]).content)}}}),AC.loadRemoteContent=function(a,b,c,d,e,f){if("string"==typeof a){"boolean"!=typeof b&&(b=!0),"boolean"!=typeof c&&(c=!0);var g=arguments.callee,h=g._loadArgumentsByUrl[a];if(!h){g._loadArgumentsByUrl[a]={contentURL:a,importScripts:b,importCSS:c,callback:d,context:e,delegate:f};var i={method:"get",onSuccess:arguments.callee.loadTemplateHTMLFromRequest,onFailure:arguments.callee.failedToadTemplateHTMLFromRequest,onException:function(a,b){throw b}};a.match(/\.json$/)||(i.requestHeaders={Accept:"text/xml"},i.onCreate=function(a){a.request.overrideMimeType("text/xml")}),new Ajax.Request(a,i)}}},AC.loadRemoteContent._loadArgumentsByUrl={},AC.loadRemoteContent.loadTemplateHTMLFromRequest=function(a){var b=a.request.url,c=(arguments.callee,AC.loadRemoteContent._loadArgumentsByUrl[b]),d=window.document,e=a.responseXMLValue().documentElement;AC.Detector.isIEStrict()&&(e=e.ownerDocument);var d=window.document,f=document.createDocumentFragment();c.importScripts&&AC.loadRemoteContent.importScriptsFromXMLDocument(e,f,c),c.importCSS&&AC.loadRemoteContent.importCssFromXMLDocumentAtLocation(e,b,c);var g=null,h=null,i=e.getElementsByTagName("body")[0];if(i){i.normalize();var h=Element.Methods.childNodeWithNodeTypeAtIndex(i,Node.ELEMENT_NODE,0);if(h)g=d._importNode(h,!0),g.cleanSpaces&&g.cleanSpaces(!0);else{i.cleanSpaces?i.cleanSpaces(!0):"function"==typeof i.normalize&&i.normalize();var j=i.childNodes;g=d.createDocumentFragment();for(var k=0,l=0;l=j[k];k++){var m=d._importNode(l,!0);g.appendChild(m)}}var n=c.callback;n(g,f,c.context)}},AC.loadRemoteContent.javascriptTypeValueRegExp=new RegExp("text/javascript","i"),AC.loadRemoteContent.javascriptLanguageValueRegExp=new RegExp("javascript","i"),AC.loadRemoteContent.documentScriptsBySrc=function(){if(!AC.loadRemoteContent._documentScriptsBySrc){AC.loadRemoteContent._documentScriptsBySrc={};var a=document.getElementsByTagName("script");if(!a||0===a.length)return AC.loadRemoteContent._documentScriptsBySrc;for(var b=0,c=null;c=a[b];b++){var d=c.getAttribute("type"),e=null,f=c.getAttribute("language");if(this.javascriptTypeValueRegExp.test(d)||this.javascriptLanguageValueRegExp.test(f)){if(c.hasAttribute)var g=c.hasAttribute("src");else var g=Element.Methods.hasAttribute(c,"src");if(g){var e=c.getAttribute("src");AC.loadRemoteContent._documentScriptsBySrc[e]=e}}}}return AC.loadRemoteContent._documentScriptsBySrc},AC.loadRemoteContent.importScriptsFromXMLDocument=function(a,b,c){var d,e,f,g,h=a.getElementsByTagName("script"),i=c.contentURL,j=c.delegate,k=c.context,l=j&&"function"==typeof j.shouldImportScriptForContentURL,m=navigator.userAgent.toLowerCase(),n=AC.Detector.isIEStrict()&&parseInt(m.substring(m.lastIndexOf("msie ")+5))<9,o=!0;b||(b=document.createDocumentFragment());for(var p=AC.loadRemoteContent.documentScriptsBySrc(),q=0,r=null;r=h[q];q++)if(d=r.getAttribute("type"),e=null,o=!0,f=r.getAttribute("language"),(this.javascriptTypeValueRegExp.test(d)||this.javascriptLanguageValueRegExp.test(f))&&(r.hasAttribute?(g=r.hasAttribute("src"),e=r.getAttribute("src")):(e=r.getAttribute("src"),g=null!=e&&""!==e),"Redirect"!==r.getAttribute("id")&&(!l||j.shouldImportScriptForContentURL(r,i,k))))if(g){if(!p.hasOwnProperty(e)){var s=document.createElement("script");s.setAttribute("type","text/javascript"),n?(s.tmp_src=e,s.onreadystatechange=function(){var a,b=window.event.srcElement;b.isLoaded||"complete"!=b.readyState&&"loaded"!=b.readyState||(a=b.tmp_src,a?(b.tmp_src=null,b.src=a,b.isLoaded=!1):(b.onreadystatechange=null,b.isLoaded=!0))}):s.src=e,AC.loadRemoteContent._documentScriptsBySrc[e]=e,b.appendChild(s)}}else{var s=document.createElement("script");if(s.setAttribute("type","text/javascript"),n){var t=new Function(r.text);s.onreadystatechange=function(){var a=window.event.srcElement;a.isLoaded||"complete"!=a.readyState&&"loaded"!=a.readyState||(a.onreadystatechange=null,a.isLoaded=!0,t())}}else s.text=r.text;AC.loadRemoteContent._documentScriptsBySrc[e]=e,b.appendChild(s)}return b},AC.loadRemoteContent.insertScriptFragment=function(a){if(a){AC.isDomReady=!1,Event._domReady.done=!1;var b,c,d=document.getElementsByTagName("head")[0],e=a.childNodes,f=function(){var a;(!window.event||(a=window.event.srcElement)&&(a.isLoaded||"undefined"==typeof a.isLoaded&&("complete"==a.readyState||"loaded"==a.readyState)))&&(arguments.callee.loadedCount++,a&&!a.isLoaded&&(a.onreadystatechange=null,a.isLoaded=!0),arguments.callee.loadedCount===arguments.callee.loadingCount&&Event._domReady())};for(f.loadedCount=0,f.loadingCount=a.childNodes.length,c=0;b=e[c];c++)if(b.addEventListener)b.addEventListener("load",f,!1);else if("function"==typeof b.onreadystatechange){var g=b.onreadystatechange;b.onreadystatechange=function(){var a=window.event.srcElement;g.call(a),f()}}else b.onreadystatechange=f;d.appendChild(a),d=null}},AC.loadRemoteContent.documentLinksByHref=function(){if(!AC.loadRemoteContent._documentLinksByHref){AC.loadRemoteContent._documentLinksByHref={};var a=document.getElementsByTagName("link");if(!a||0===a.length)return AC.loadRemoteContent._documentLinksByHref;for(var b=0,c=null;c=a[b];b++){{c.getAttribute("type")}if("text/css"===c.type.toLowerCase()){var d=null;if(c.hasAttribute)var e=c.hasAttribute("href");else var e=Element.hasAttribute(c,"href");if(e){var d=c.getAttribute("href");AC.loadRemoteContent._documentLinksByHref[d]=d}}}}return AC.loadRemoteContent._documentLinksByHref},AC.loadRemoteContent.__importCssElementInHeadFromLocation=function(a,b,c){var d="LINK"===a.tagName.toUpperCase();if(d){var e=a.getAttribute("type");if(!e||e&&"text/css"!==e.toLowerCase())return;var f=a.getAttribute("href");if(!f.startsWith("http")&&!f.startsWith("/")){var g=f;c.pathExtension().length>0&&(c=c.stringByDeletingLastPathComponent()),f=c.stringByAppendingPathComponent(g)}if(AC.Detector.isIEStrict()){window.document.createStyleSheet(f,1)}else{var h=window.document.importNode(a,!0);h.href=f}AC.loadRemoteContent.documentLinksByHref()[f]=f}(!AC.Detector.isIEStrict()||AC.Detector.isIEStrict()&&!d)&&b.insertBefore(h,b.firstChild)},AC.loadRemoteContent.importCssFromXMLDocumentAtLocation=function(a,b){var c=window.document.getElementsByTagName("head")[0],d=[];if(d.addObjectsFromArray(a.getElementsByTagName("style")),d.addObjectsFromArray(a.getElementsByTagName("link")),d)for(var e=AC.loadRemoteContent.documentLinksByHref(),f=0,g=null;g=d[f];f++){var h=g.getAttribute("href");e.hasOwnProperty(h)||this.__importCssElementInHeadFromLocation(g,c,b)}},Ajax.Request.prototype._overrideMimeType=null,Ajax.Request.prototype.overrideMimeType=function(a){this._overrideMimeType=a,this.transport.overrideMimeType&&this.transport.overrideMimeType(a)},Ajax.Request.prototype._doesOverrideXMLMimeType=function(){return"text/xml"===this._overrideMimeType},Ajax.Response.prototype.responseXMLValue=function(){if(AC.Detector.isIEStrict()){var a=this.transport.responseXML.documentElement;!a&&this.request._doesOverrideXMLMimeType()&&this.transport.responseXML.loadXML(this.transport.responseText)}return this.transport.responseXML},"undefined"!=typeof AC.Retina&&(AC.Retina.SwapView=function(){var a;return null===AC.Retina.sharedInstance()?!1:(a=function(a){if(a.event_data.data.incomingView&&Object.isElement(a.event_data.data.incomingView.content)){var b=a.event_data.data.incomingView.content,c=a.event_data.data.sender.view.view();AC.Retina.sharedInstance().replace(b,c)}},a=a.bindAsEventListener(this),void("Listener"in Event&&"undefined"!=typeof AC.ViewMaster&&Event.Listener.listenForEvent(AC.ViewMaster,"ViewMasterDidShowNotification",!1,a)))},Event.observe(window,"load",function(){window.setTimeout(AC.Retina.SwapView,20)}));